module Snowflaked
  VERSION: String
  MAX_MACHINE_ID: Integer

  class Error < StandardError
  end

  class ConfigurationError < Error
  end

  class Configuration
    attr_accessor machine_id: Integer?
    attr_accessor epoch: Time?

    def initialize: () -> void
    def machine_id_value: () -> Integer
    def epoch_ms: () -> Integer?

    private

    def default_machine_id: () -> Integer
    def env_machine_id: () -> Integer?
    def hostname_pid_hash: () -> Integer
  end

  def self.configuration: () -> Configuration
  def self.configure: () ?{ (Configuration) -> void } -> Configuration
  def self.id: () -> Integer
  def self.parse: (Integer id) -> Hash[Symbol, Integer]
  def self.timestamp: (Integer id) -> Time
  def self.machine_id: (Integer id) -> Integer
  def self.timestamp_ms: (Integer id) -> Integer
  def self.sequence: (Integer id) -> Integer

  private

  def self.ensure_initialized!: () -> nil
end
